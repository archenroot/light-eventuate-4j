<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-us">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>Getting Started - Light Eventuate 4J - An event sourcing and CQRS framework with Kafka</title>
    <meta name="generator" content="Hugo 0.21" />

    
    <meta name="description" content="Light Eventuate Docs">
    
    <link rel="canonical" href="https://networknt.github.io/light-eventuate-4j/getting-started/">
    
    <meta name="author" content="Steve Hu, Gavin Chen">
    

    <meta property="og:url" content="https://networknt.github.io/light-eventuate-4j/getting-started/">
    <meta property="og:title" content="Light Eventuate 4J - An event sourcing and CQRS framework with Kafka">
    <meta property="og:image" content="https://networknt.github.io/light-eventuate-4j/images/logo.png">
    <meta name="apple-mobile-web-app-title" content="Light Eventuate 4J - An event sourcing and CQRS framework with Kafka">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="https://networknt.github.io/light-eventuate-4j/images/favicon.ico">
    <link rel="icon" type="image/x-icon" href="https://networknt.github.io/light-eventuate-4j/images/favicon.ico">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('https://networknt.github.io/light-eventuate-4j/fonts/icon.eot');
        src: url('https://networknt.github.io/light-eventuate-4j/fonts/icon.eot')
               format('embedded-opentype'),
             url('https://networknt.github.io/light-eventuate-4j/fonts/icon.woff')
               format('woff'),
             url('https://networknt.github.io/light-eventuate-4j/fonts/icon.ttf')
               format('truetype'),
             url('https://networknt.github.io/light-eventuate-4j/fonts/icon.svg')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="https://networknt.github.io/light-eventuate-4j/stylesheets/application.css">
    <link rel="stylesheet" href="https://networknt.github.io/light-eventuate-4j/stylesheets/temporary.css">
    <link rel="stylesheet" href="https://networknt.github.io/light-eventuate-4j/stylesheets/palettes.css">
    <link rel="stylesheet" href="https://networknt.github.io/light-eventuate-4j/stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu&#43;Mono">
    <style>
      body, input {
        font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <script src="https://networknt.github.io/light-eventuate-4j/javascripts/modernizr.js"></script>

    

  </head>
  <body class="palette-primary-red palette-accent-teal">



	
	


<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        Getting Started
      </div>
    </div>

    

    
    <div class="button button-github" role="button" aria-label="GitHub">
      <a href="https://github.com/stevehu" title="@stevehu on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
    </div>
    
    
        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <a href="https://github.com/networknt/light-eventuate-4j" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="https://networknt.github.io/light-eventuate-4jimages/logo.png">
        </div>
      
      <div class="name">
        <strong>Light Eventuate 4J - An event sourcing and CQRS framework with Kafka <span class="version">1.3.1</span></strong>
        
          <br>
          networknt/light-eventuate-4j
        
      </div>
    </div>
  </a>

  <div class="scrollable">
    <div class="wrapper">
      
        <ul class="repo">
          <li class="repo-download">
            <a href="https://github.com/networknt/light-eventuate-4j/archive/master.zip" target="_blank" title="Download" data-action="download">
              <i class="icon icon-download"></i> Download
            </a>
          </li>
          <li class="repo-stars">
            <a href="https://github.com/networknt/light-eventuate-4j/stargazers" target="_blank" title="Stargazers" data-action="star">
              <i class="icon icon-star"></i> Stars
              <span class="count">&ndash;</span>
            </a>
          </li>
        </ul>
        <hr>
      

      <div class="toc">
        
        <ul>
          




<li>
  
    



<a class="current" title="Getting started" href="https://networknt.github.io/light-eventuate-4j/getting-started/">
	
	Getting started
</a>


<ul id="scrollspy">
</ul>


  
</li>



<li>
  
    



<a  title="Architecture" href="https://networknt.github.io/light-eventuate-4j/architecture/">
	
	Architecture
</a>



  
</li>



<li>
  
    



<a  title="Design" href="https://networknt.github.io/light-eventuate-4j/design/">
	
	Design
</a>



  
</li>



<li>
  
    



<a  title="Tutorial" href="https://networknt.github.io/light-eventuate-4j/tutorial/">
	
	Tutorial
</a>



  
</li>



<li>
  
    



<a  title="Example" href="https://networknt.github.io/light-eventuate-4j/example/">
	
	Example
</a>



  
</li>



<li>
  
    



<a  title="Issues &amp; Help" href="https://github.com/networknt/light-eventuate/issues">
	
	Issues &amp; Help
</a>



  
</li>



<li>
  
    



<a  title="Roadmap" href="https://networknt.github.io/light-eventuate-4j/roadmap/">
	
	Roadmap
</a>



  
</li>



<li>
  
    



<a  title="License" href="https://www.apache.org/licenses/LICENSE-2.0">
	
	License
</a>



  
</li>



<li>
  
    



<a  title="Introduction" href="https://networknt.github.io/light-eventuate-4j/index.html">
	
	Introduction
</a>



  
</li>


        </ul>
        

        
        <hr>
        <span class="section">The author</span>
        
        <ul>
          

          
          <li>
            <a href="https://github.com/stevehu" target="_blank" title="@stevehu on GitHub">
              @stevehu on GitHub
            </a>
          </li>
          

          
          <li>
            <a href="mailto:stevehu@gmail.com" title="Email of stevehu@gmail.com">
              Contact via email
            </a>
          </li>
          
        </ul>
        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1>Getting Started </h1>

			

<h2 id="introduction">Introduction</h2>

<p>One of the major issues that we have seen occur in a system with microservices is the way transactions
work when they span over different services. Within our old monolithic architecture, we have been using
distributed transactions to resolve this, but they come with their own issues. It is very hard to avoid
deadlocks and scale the application when business grows.</p>

<p>Distributed transaction management is a key architectural consideration that needs to be addressed whenever
you are proposing a microservices deployment model to a customer. For developers from the monolithic
relational database world, it is not an easy idea to grasp. In a monolithic application with a relational
data store, transactions are ACID (atomic, consistent, isolated, and durable) in nature and follow a simple
pessimistic control for data consistency. Distributed transactions are always guided by a two-phase commit
protocol, where first all the changes are temporarily applied and then committed to, or rolled back,
depending on whether or not all the transactions were successful or there was any error. You could easily
write queries that fetched data from different relational sources and the distributed transaction coordinator
model supported transaction control across disparate relational data sources.</p>

<p>In today&rsquo;s world, however, the focus is on modular, self-contained APIs. To make these services self-contained
and aligned with the microservices deployment paradigm, the data is also self-contained within the module,
loosely coupled from other APIs. Encapsulating the data allows the services to grow independently, but a major
problem is dealing with keeping data consistent across the services. If every service has its own database,
then distributed transaction is not an option.</p>

<p>A microservices architecture promotes availability over consistency, hence leveraging a distributed transaction
coordinator with a two-phase commit protocol is usually not an option. It gets even more complicated with the
idea that these loosely-coupled data repositories might not necessarily all be relational stores and could be a
polyglot with a mix of relational and NoSQL data stores. The idea of having an immediately consistent state
is difficult. What you should look forward to, however, is an architecture that promotes eventual consistency
like <a href="https://networknt.github.io/light-eventuate-4j/architecture/cqrs/">CQRS</a> and <a href="https://networknt.github.io/light-eventuate-4j/architecture/event-sourcing/">Event Sourcing</a>.
An event driven architecture can support a BASE (basic availability, soft-state, and eventual consistency)
transaction model. This is a great technique to solve the problem of handling transactions across services
and customers can be convinced to negotiate the contract towards a BASE model since usually transactional
consistency across functional boundaries is mostly about frequent change of states, and consistency rules
can be relaxed to let the final state be eventually visible to the consumers.</p>

<h2 id="distributed-data-management-problems-in-a-microservice-architecture">Distributed data management problems in a microservice architecture:</h2>

<p>In microservice system, normally each service has its own database. Some business transactions,
however, span multiple services so you need a mechanism to ensure data consistency across
services. For example, let’s imagine that you are building an e-commerce store where customers
have a credit limit. The application must ensure that a new order will not exceed the customer’s
credit limit. Since Orders and Customers are in different databases the application cannot simply
use a local ACID transaction.</p>

<h2 id="event-driven-architecture">Event-driven architecture</h2>

<p>A good way to solve these distributed data management challenges is by using an event-driven
architecture. In an event-driven application services publish and consume events. A service
publishes an event whenever it changes the state of an entity. Another service can subscribe
to that event and update its own entities and possibly publish other events. You can implement
a business transaction that updates multiple entities as a series of steps, each of which
updates one entity and publishes an event that triggers the next step. Also, a service can
maintain the consistency of a replica by subscribing to the events that are published when
the master copy is updated.</p>

<h2 id="event-sourcing">Event Sourcing</h2>

<p>One essential requirement in an EDA is the ability to atomically update state and publish events.
In a traditional application the database storing the state and the message broker could participate
in a distributed transactions. But the lack of 2PC in a cloud native world makes this a challenging
problem to solve.</p>

<p>A good solution to this problem is to use event sourcing. Event sourcing persists the state of
a business entity as a sequence of state-changing events. Whenever the state of a business entity
changes, a new event is appended to the list of events. Since saving an event is a single
operation, it is inherently atomic. The application reconstructs an entity’s current state by
replaying the events.</p>

<p>Applications save events in an event store, which is a database of events. The store has an API
for adding and retrieving an entity’s events. The event store also behaves like a message broker.
It provides an API that enables services to subscribe to events. When a service saves an event
in the event store, it is delivered to all interested subscribers.</p>

<h2 id="some-useful-links">Some useful links</h2>

<p><a href="http://www.grahamlea.com/2016/08/distributed-transactions-microservices-icebergs/">Distributed Transactions: The Icebergs of Microserivces</a></p>

<p><a href="https://dzone.com/articles/transactions-in-microservices">Transactions in Microservices</a></p>

<p><a href="https://www.infoq.com/articles/microservices-aggregates-events-cqrs-part-1-richardson">Developing Transactional Microservices Using Aggregates, Event Sourcing and CQRS - Part 1</a></p>

<p><a href="https://www.infoq.com/articles/microservices-aggregates-events-cqrs-part-2-richardson">Developing Transactional Microservices Using Aggregates, Event Sourcing and CQRS - Part 2</a></p>


			<aside class="copyright" role="note">
				
				&copy; 2017 Released under the MIT license &ndash;
				
				Documentation built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				using the
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">Material</a> theme.
			</aside>

			<footer class="footer">
				

<nav class="pagination" aria-label="Footer">
  <div class="previous">
  
      <a href="https://networknt.github.io/light-eventuate-4j/architecture/" title="Architecture">
        <span class="direction">
          Previous
        </span>
        <div class="page">
          <div class="button button-previous" role="button" aria-label="Previous">
            <i class="icon icon-back"></i>
          </div>
          <div class="stretch">
            <div class="title">
              Architecture
            </div>
          </div>
        </div>
      </a>
  
  </div>

  <div class="next">
  
      <a href="https://networknt.github.io/light-eventuate-4j/" title="Introduction">
        <span class="direction">
          Next
        </span>
        <div class="page">
          <div class="stretch">
            <div class="title">
              Introduction
            </div>
          </div>
          <div class="button button-next" role="button" aria-label="Next">
            <i class="icon icon-forward"></i>
          </div>
        </div>
      </a>
  
  </div>
</nav>





			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = 'https:\/\/networknt.github.io\/light-eventuate-4j';
      var repo_id  = 'networknt\/light-eventuate-4j';
    
    </script>

    <script src="https://networknt.github.io/light-eventuate-4j/javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;

            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }


        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "#";
            headers[i].appendChild(a);
        }
      }
    </script>

    

    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>

