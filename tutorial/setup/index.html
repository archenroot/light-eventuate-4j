<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-us">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>Framework Setup - Light Eventuate 4J - An event sourcing and CQRS framework with Kafka</title>
    <meta name="generator" content="Hugo 0.21" />

    
    <meta name="description" content="Light Eventuate Docs">
    
    <link rel="canonical" href="https://networknt.github.io/light-eventuate-4j/tutorial/setup/">
    
    <meta name="author" content="Steve Hu, Gavin Chen">
    

    <meta property="og:url" content="https://networknt.github.io/light-eventuate-4j/tutorial/setup/">
    <meta property="og:title" content="Light Eventuate 4J - An event sourcing and CQRS framework with Kafka">
    <meta property="og:image" content="https://networknt.github.io/light-eventuate-4j/images/logo.png">
    <meta name="apple-mobile-web-app-title" content="Light Eventuate 4J - An event sourcing and CQRS framework with Kafka">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="https://networknt.github.io/light-eventuate-4j/images/favicon.ico">
    <link rel="icon" type="image/x-icon" href="https://networknt.github.io/light-eventuate-4j/images/favicon.ico">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('https://networknt.github.io/light-eventuate-4j/fonts/icon.eot');
        src: url('https://networknt.github.io/light-eventuate-4j/fonts/icon.eot')
               format('embedded-opentype'),
             url('https://networknt.github.io/light-eventuate-4j/fonts/icon.woff')
               format('woff'),
             url('https://networknt.github.io/light-eventuate-4j/fonts/icon.ttf')
               format('truetype'),
             url('https://networknt.github.io/light-eventuate-4j/fonts/icon.svg')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="https://networknt.github.io/light-eventuate-4j/stylesheets/application.css">
    <link rel="stylesheet" href="https://networknt.github.io/light-eventuate-4j/stylesheets/temporary.css">
    <link rel="stylesheet" href="https://networknt.github.io/light-eventuate-4j/stylesheets/palettes.css">
    <link rel="stylesheet" href="https://networknt.github.io/light-eventuate-4j/stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu&#43;Mono">
    <style>
      body, input {
        font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <script src="https://networknt.github.io/light-eventuate-4j/javascripts/modernizr.js"></script>

    

  </head>
  <body class="palette-primary-red palette-accent-teal">



	
	


<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        Framework Setup
      </div>
    </div>

    

    
    <div class="button button-github" role="button" aria-label="GitHub">
      <a href="https://github.com/stevehu" title="@stevehu on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
    </div>
    
    
        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <a href="https://github.com/networknt/light-eventuate-4j" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="https://networknt.github.io/light-eventuate-4jimages/logo.png">
        </div>
      
      <div class="name">
        <strong>Light Eventuate 4J - An event sourcing and CQRS framework with Kafka <span class="version">1.3.3</span></strong>
        
          <br>
          networknt/light-eventuate-4j
        
      </div>
    </div>
  </a>

  <div class="scrollable">
    <div class="wrapper">
      
        <ul class="repo">
          <li class="repo-download">
            <a href="https://github.com/networknt/light-eventuate-4j/archive/master.zip" target="_blank" title="Download" data-action="download">
              <i class="icon icon-download"></i> Download
            </a>
          </li>
          <li class="repo-stars">
            <a href="https://github.com/networknt/light-eventuate-4j/stargazers" target="_blank" title="Stargazers" data-action="star">
              <i class="icon icon-star"></i> Stars
              <span class="count">&ndash;</span>
            </a>
          </li>
        </ul>
        <hr>
      

      <div class="toc">
        
        <ul>
          




<li>
  
    



<a  title="Getting started" href="https://networknt.github.io/light-eventuate-4j/getting-started/">
	
	Getting started
</a>



  
</li>



<li>
  
    



<a  title="Architecture" href="https://networknt.github.io/light-eventuate-4j/architecture/">
	
	Architecture
</a>



  
</li>



<li>
  
    



<a  title="Design" href="https://networknt.github.io/light-eventuate-4j/design/">
	
	Design
</a>



  
</li>



<li>
  
    



<a  title="Tutorial" href="https://networknt.github.io/light-eventuate-4j/tutorial/">
	
	Tutorial
</a>



  
</li>



<li>
  
    



<a  title="Example" href="https://networknt.github.io/light-eventuate-4j/example/">
	
	Example
</a>



  
</li>



<li>
  
    



<a  title="Issues &amp; Help" href="https://github.com/networknt/light-eventuate/issues">
	
	Issues &amp; Help
</a>



  
</li>



<li>
  
    



<a  title="Roadmap" href="https://networknt.github.io/light-eventuate-4j/roadmap/">
	
	Roadmap
</a>



  
</li>



<li>
  
    



<a  title="License" href="https://www.apache.org/licenses/LICENSE-2.0">
	
	License
</a>



  
</li>



<li>
  
    



<a  title="Introduction" href="https://networknt.github.io/light-eventuate-4j/index.html">
	
	Introduction
</a>



  
</li>


        </ul>
        

        
        <hr>
        <span class="section">The author</span>
        
        <ul>
          

          
          <li>
            <a href="https://github.com/stevehu" target="_blank" title="@stevehu on GitHub">
              @stevehu on GitHub
            </a>
          </li>
          

          
          <li>
            <a href="mailto:stevehu@gmail.com" title="Email of stevehu@gmail.com">
              Contact via email
            </a>
          </li>
          
        </ul>
        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1>Framework Setup </h1>

			

<h2 id="introduction">Introduction</h2>

<p>Microservices enable businesses to innovate faster and stay ahead of the competition.
But one major challenge with the microservices architecture is the management of distributed data. Each microservice has its own private database.
It is difficult to implement business transactions that maintain data consistency across multiple services as well as queries that retrieve data from multiple services.</p>

<p>The light event sourcing framework provides a simple yet powerful event-driven programming model that solves the distributed data management problems inherent in a microservice architecture.
The programming model is based on two well established patterns: Event Sourcing and Command Query Responsibility Segregation (CQRS).
Eventuate consists of a scalable, distributed event store server and client libraries for various languages and frameworks.</p>

<h2 id="prepare-workspace">Prepare workspace</h2>

<p>All specifications and code of the services are on github.com but we are going to
redo it again by following the steps in the tutorial. Let&rsquo;s first create a
workspace. I have created a directory named networknt under user directory.</p>

<p>Checkout related projects.</p>

<pre><code>cd ~/networknt
git clone git@github.com:networknt/light-4j.git
git clone git@github.com:networknt/light-rest-4j.git
git clone git@github.com:networknt/light-codegen.git
git clone git@github.com:networknt/light-eventuate-4j.git
git clone git@github.com:networknt/light-eventuate-example.git
git clone git@github.com:networknt/light-hybrid-4j.git


## Prepare workspace

Go into the projects folder above, and build the project with maven

</code></pre>

<p>mvn clean install</p>

<pre><code>
## Prepare and start event store (without docker)

The light event sourcing framework build on event store which used to save and dispatch events for calling microservices.
The event store is build upon the database (mysql or postgresql) and distributed stream system (Kafka). For the local environment (wothout docker). Please follow below step to setup event store.


--- Mysql (by default: use mysql as database to save event/entity/snapshot records):

-- Download mysql database (version: 5.7.18 and above) and install it in local environment.

-- start mysql database: &gt;mysqld

-- get and run DB setup script from folder: /light-eventuate-4j/client/src/main/resources/mysql-event-store-schema.sql



--- Kafka:

--Download Kafka (distributed steam system) from for version (2.11-0.10.2.0 or above):
  http://www.us.apache.org/dist/kafka/0.10.2.0/kafka_2.11-0.10.2.0.tgz

-- Start zookeeper server and Kafka server:
   Kafka uses ZooKeeper so you need to first start a ZooKeeper server if you don't already have one. You can use the convenience script packaged with kafka to get a quick-and-dirty single-node ZooKeeper instance.
  &gt; bin/zookeeper-server-start.sh config/zookeeper.properties

--- Start Kafka server
  &gt;bin/kafka-server-start.sh config/server.properties

--- postgresql (if user select postgreSql as database to save event/entity/snapshot records)
  --TODO



## Prepare and start event sourcing CDC (capture data change service).

CDC service use database replication to populate data from database (mysql) to distributed stream system (kafka).

-- go to cdcservice project module:
  cd cdcservice

-- run command line:
</code></pre>

<p>java -cp target/eventuate-command-1.3.3.jar com.networknt.server.Server
  ```</p>

<p>or</p>

<p>mvn exec:exec</p>

<h2 id="prepare-and-start-event-sourcing-command-side-service-and-query-side-service">Prepare and start event sourcing command side service and query side service.</h2>

<p>Normally event sourcing system will have at least two microservices:</p>

<p>command side service</p>

<p>query side service</p>

<p>For example, to use our simple todo-list example:</p>

<p>Go to light-eventuate-example/todo-list
 Build the project from command line:
   &ndash;mvn clean install</p>

<h2 id="command-side-service">Command side service</h2>

<p>Go command-service module, run command line:
   &ndash; mvn package exec:exec</p>

<h2 id="query-side-service">Query side service</h2>

<p>Prepare query side DB script: (DB script saved at: /light-eventuate-example/mysql; root user for mysql: root/rootpassword)</p>

<pre><code>create database todo_db;

CREATE  TABLE TODO (
  ID varchar(255),
  TITLE varchar(255),
  COMPLETED BOOLEAN,
  ORDER_ID INTEGER,
  ACTIVE_FLG varchar(1) DEFAULT 'Y',
  PRIMARY KEY(ID)
);

GRANT ALL PRIVILEGES ON todo_db.* TO 'mysqluser' IDENTIFIED BY 'mysqlpw';
</code></pre>

<p>Go query-service module, run command line:
   &ndash; mvn package exec:exec</p>

<h1 id="dockerization">Dockerization</h1>

<ul>
<li><a href="https://networknt.github.io/light-eventuate-4j/tutorial/docker/">How to build and create event store docker images for light-eventuate-4j framework</a></li>
</ul>

<h2 id="event-store-docker-compose">Event Store docker compose:</h2>

<p>Docker can simplify the application delivery. For light event sourcing system, to start event store by dockerization:</p>

<p>&ndash; From light-eventuate-4j project root folder: /light-eventuate-4j</p>

<p>&ndash; run docker-compose up</p>

<p>system will start ALL required event store components (mysql, zookeeper, kafka)</p>

<p>For todo-list example:</p>

<p>Prepare query side DB script: (DB script saved at: /light-eventuate-example/mysql; root user for mysql: root/rootpassword)</p>

<pre><code>  create database todo_db;

  CREATE  TABLE TODO (
    ID varchar(255),
    TITLE varchar(255),
    COMPLETED BOOLEAN,
    ORDER_ID INTEGER,
    ACTIVE_FLG varchar(1) DEFAULT 'Y',
    PRIMARY KEY(ID)
  );

  GRANT ALL PRIVILEGES ON todo_db.* TO 'mysqluser' IDENTIFIED BY 'mysqlpw';
</code></pre>

<h2 id="for-restful-services">For Restful Services</h2>

<p>Start CDC service:</p>

<p>&ndash; From light-eventuate-4j project root folder: /light-eventuate-4j</p>

<p>&ndash; run docker-compose -f docker-compose-cdcservice.yml up</p>

<p>Run Command/Query side service:</p>

<p>&ndash; From todo-list example root folder: /light-eventuate-example/todo-list</p>

<p>&ndash; run docker-compose up</p>

<h2 id="for-hybrid-api-services">For Hybrid API Services</h2>

<p>&ndash; From light-eventuate-4j project root folder: /light-eventuate-4j</p>

<p>&ndash; Run docker-compose -f docker-compose-service.yml up</p>

<h2 id="integration">Integration</h2>

<h2 id="performance">Performance</h2>

<h2 id="production">Production</h2>

<h2 id="conclusion">Conclusion</h2>


			<aside class="copyright" role="note">
				
				&copy; 2017 Released under the MIT license &ndash;
				
				Documentation built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				using the
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">Material</a> theme.
			</aside>

			<footer class="footer">
				

<nav class="pagination" aria-label="Footer">
  <div class="previous">
  
      <a href="https://networknt.github.io/light-eventuate-4j/tutorial/unit-test/" title="Unit Test">
        <span class="direction">
          Previous
        </span>
        <div class="page">
          <div class="button button-previous" role="button" aria-label="Previous">
            <i class="icon icon-back"></i>
          </div>
          <div class="stretch">
            <div class="title">
              Unit Test
            </div>
          </div>
        </div>
      </a>
  
  </div>

  <div class="next">
  
  </div>
</nav>





			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = 'https:\/\/networknt.github.io\/light-eventuate-4j';
      var repo_id  = 'networknt\/light-eventuate-4j';
    
    </script>

    <script src="https://networknt.github.io/light-eventuate-4j/javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;

            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }


        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "#";
            headers[i].appendChild(a);
        }
      }
    </script>

    

    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>

