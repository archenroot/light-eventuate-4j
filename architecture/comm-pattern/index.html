<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-us">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>Communication Patterns - Light Eventuate 4J - An event sourcing and CQRS framework with Kafka</title>
    <meta name="generator" content="Hugo 0.20.6" />

    
    <meta name="description" content="Light Eventuate Docs">
    
    <link rel="canonical" href="https://networknt.github.io/light-eventuate-4j/architecture/comm-pattern/">
    
    <meta name="author" content="Steve Hu, Gavin Chen">
    

    <meta property="og:url" content="https://networknt.github.io/light-eventuate-4j/architecture/comm-pattern/">
    <meta property="og:title" content="Light Eventuate 4J - An event sourcing and CQRS framework with Kafka">
    <meta property="og:image" content="https://networknt.github.io/light-eventuate-4j/images/logo.png">
    <meta name="apple-mobile-web-app-title" content="Light Eventuate 4J - An event sourcing and CQRS framework with Kafka">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="https://networknt.github.io/light-eventuate-4j/images/favicon.ico">
    <link rel="icon" type="image/x-icon" href="https://networknt.github.io/light-eventuate-4j/images/favicon.ico">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('https://networknt.github.io/light-eventuate-4j/fonts/icon.eot');
        src: url('https://networknt.github.io/light-eventuate-4j/fonts/icon.eot')
               format('embedded-opentype'),
             url('https://networknt.github.io/light-eventuate-4j/fonts/icon.woff')
               format('woff'),
             url('https://networknt.github.io/light-eventuate-4j/fonts/icon.ttf')
               format('truetype'),
             url('https://networknt.github.io/light-eventuate-4j/fonts/icon.svg')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="https://networknt.github.io/light-eventuate-4j/stylesheets/application.css">
    <link rel="stylesheet" href="https://networknt.github.io/light-eventuate-4j/stylesheets/temporary.css">
    <link rel="stylesheet" href="https://networknt.github.io/light-eventuate-4j/stylesheets/palettes.css">
    <link rel="stylesheet" href="https://networknt.github.io/light-eventuate-4j/stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu&#43;Mono">
    <style>
      body, input {
        font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <script src="https://networknt.github.io/light-eventuate-4j/javascripts/modernizr.js"></script>

    

  </head>
  <body class="palette-primary-red palette-accent-teal">



	
	


<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        Communication Patterns
      </div>
    </div>

    

    
    <div class="button button-github" role="button" aria-label="GitHub">
      <a href="https://github.com/stevehu" title="@stevehu on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
    </div>
    
    
        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <a href="https://github.com/networknt/light-eventuate-4j" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="https://networknt.github.io/light-eventuate-4jimages/logo.png">
        </div>
      
      <div class="name">
        <strong>Light Eventuate 4J - An event sourcing and CQRS framework with Kafka <span class="version">1.3.0</span></strong>
        
          <br>
          networknt/light-eventuate-4j
        
      </div>
    </div>
  </a>

  <div class="scrollable">
    <div class="wrapper">
      
        <ul class="repo">
          <li class="repo-download">
            <a href="https://github.com/networknt/light-eventuate-4j/archive/master.zip" target="_blank" title="Download" data-action="download">
              <i class="icon icon-download"></i> Download
            </a>
          </li>
          <li class="repo-stars">
            <a href="https://github.com/networknt/light-eventuate-4j/stargazers" target="_blank" title="Stargazers" data-action="star">
              <i class="icon icon-star"></i> Stars
              <span class="count">&ndash;</span>
            </a>
          </li>
        </ul>
        <hr>
      

      <div class="toc">
        
        <ul>
          




<li>
  
    



<a  title="Getting started" href="https://networknt.github.io/light-eventuate-4j/getting-started/">
	
	Getting started
</a>



  
</li>



<li>
  
    



<a  title="Architecture" href="https://networknt.github.io/light-eventuate-4j/architecture/">
	
	Architecture
</a>



  
</li>



<li>
  
    



<a  title="Design" href="https://networknt.github.io/light-eventuate-4j/design/">
	
	Design
</a>



  
</li>



<li>
  
    



<a  title="Tutorial" href="https://networknt.github.io/light-eventuate-4j/tutorial/">
	
	Tutorial
</a>



  
</li>



<li>
  
    



<a  title="Example" href="https://networknt.github.io/light-eventuate-4j/example/">
	
	Example
</a>



  
</li>



<li>
  
    



<a  title="Issues &amp; Help" href="https://github.com/networknt/light-eventuate/issues">
	
	Issues &amp; Help
</a>



  
</li>



<li>
  
    



<a  title="Roadmap" href="https://networknt.github.io/light-eventuate-4j/roadmap/">
	
	Roadmap
</a>



  
</li>



<li>
  
    



<a  title="License" href="https://www.apache.org/licenses/LICENSE-2.0">
	
	License
</a>



  
</li>



<li>
  
    



<a  title="Introduction" href="https://networknt.github.io/light-eventuate-4j/index.html">
	
	Introduction
</a>



  
</li>


        </ul>
        

        
        <hr>
        <span class="section">The author</span>
        
        <ul>
          

          
          <li>
            <a href="https://github.com/stevehu" target="_blank" title="@stevehu on GitHub">
              @stevehu on GitHub
            </a>
          </li>
          

          
          <li>
            <a href="mailto:stevehu@gmail.com" title="Email of stevehu@gmail.com">
              Contact via email
            </a>
          </li>
          
        </ul>
        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1>Communication Patterns </h1>

			

<h1 id="introduction">Introduction</h1>

<p>In a monolithic application, components invoke one another via method or function calls. In contrast,
a microservices-based application might be distributed on multiple Docker containers or VMs or multiple
machines. Each service instance is typically a process and services much interact using an inter-process
communication mechanism.</p>

<h1 id="patterns">Patterns</h1>

<p>There are two major styles in client/service communication.</p>

<h2 id="synchronous">Synchronous</h2>

<p>The client expects a timely response from the service and might even block while it waits.</p>

<p>When using a synchronous, request/response-based IPC mechanism, a client sends a request to a service.
The service processes the request and sends back a response. In many clients, the thread that makes the
request blocks while waiting for a response. Other clients might use asynchronous, event-driven client
code that is perhaps encapsulated by Futures or Rx Observables. However, unlike when using messaging, the
client assumes that the response will arrive in a timely fashion. There are numerous styles to choose
from. Two popular HTTP styles are REST and RPC.</p>

<p>There are numerous benefits to using a communication style that is based on HTTP:</p>

<ul>
<li>HTTP is simple and familiar.</li>
<li>You can test an HTTP API from within a browser using an extension such as Postman or from the command
line using curl (assuming JSON or some other text format is used).</li>
<li>It directly supports request/response-style communication.</li>
<li>HTTP is, of course, firewall-friendly.</li>
<li>It doesn’t require an intermediate broker, which simplifies the system’s architecture.</li>
</ul>

<p>There are some drawbacks to using HTTP:</p>

<ul>
<li>It only directly supports the request/response style of interaction. You can use HTTP for notifications
but the server must always send an HTTP response.</li>
<li>Because the client and service communicate directly (without an intermediary to buffer messages), they
must both be running for the duration of the exchange.</li>
<li>The client must know the location (i.e., the URL) of each service instance and this is a non-trivial
problem in a modern application. Clients must use a service discovery mechanism to locate service instances.</li>
</ul>

<h2 id="asynchronous-message-based-communication">Asynchronous, Message-Based Communication</h2>

<p>The client doesn’t block while waiting for a response, and the response, if any, isn’t necessarily
sent immediately.</p>

<p>When using messaging, processes communicate by asynchronously exchanging messages. A client makes a
request to a service by sending it a message. If the service is expected to reply, it does so by sending
a separate message back to the client. Since the communication is asynchronous, the client does not block
waiting for a reply. Instead, the client is written assuming that the reply will not be received immediately.</p>

<p>A message consists of headers (metadata such as the sender) and a message body. Messages are exchanged
over channels. Any number of producers can send messages to a channel. Similarly, any number of consumers
can receive messages from a channel.</p>

<p>There are many advantages to using messaging:</p>

<ul>
<li>Decouples the client from the service</li>
</ul>

<p>A client makes a request simply by sending a message to the appropriate channel. The client is completely
unaware of the service instances. It does not need to use a discovery mechanism to determine the location
of a service instance.</p>

<ul>
<li>Message buffering</li>
</ul>

<p>With a synchronous request/response protocol, such as a HTTP, both the client and service must be available
for the duration of the exchange. In contrast, a message broker queues up the messages written to a channel
until they can be processed by the consumer. This means, for example, that an online store can accept orders
from customers even when the order fulfillment system is slow or unavailable. The order messages simply queue
up.</p>

<ul>
<li>Flexible client-service interactions</li>
</ul>

<p>Messaging supports all of the interaction styles described earlier.</p>

<ul>
<li>Explicit inter-process communication</li>
</ul>

<p>RPC-based mechanisms attempt to make invoking a remote service look the same as calling a local service.
However, because of the laws of physics and the possibility of partial failure, they are in fact quite
different. Messaging makes these differences very explicit so developers are not lulled into a false sense
of security.</p>

<p>There are, however, some downsides to using messaging:</p>

<ul>
<li>Additional operational complexity</li>
</ul>

<p>The messaging system is yet another system component that must be installed, configured, and operated. It’s
essential that the message broker be highly available, otherwise system reliability is impacted.</p>

<ul>
<li>Complexity of implementing request/response-based interaction</li>
</ul>

<p>Request/response-style interaction requires some work to implement. Each request message must contain a reply
channel identifier and a correlation identifier. The service writes a response message containing the
correlation ID to the reply channel. The client uses the correlation ID to match the response with the request.
It is often easier to use an IPC mechanism that directly supports request/response.</p>

<ul>
<li>Client needs to discover location of message broker</li>
</ul>

<p>Given message broker is the most important of component in the infrastructure, it is normally a cluster of
serveral instances. This makes client more complicated to locate which instance to communicate with and how
to fail over to other instances when the current one fails.</p>

<h1 id="summary">Summary</h1>

<p>Microservices must communicate using an inter-process communication mechanism. When designing how your
services will communicate, you need to consider various issues: how services interact, how to specify the
API for each service, how to evolve the APIs, and how to handle partial failure. There are two kinds of IPC
mechanisms that microservices can use, asynchronous messaging and synchronous request/response.</p>


			<aside class="copyright" role="note">
				
				&copy; 2017 Released under the MIT license &ndash;
				
				Documentation built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				using the
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">Material</a> theme.
			</aside>

			<footer class="footer">
				

<nav class="pagination" aria-label="Footer">
  <div class="previous">
  
      <a href="https://networknt.github.io/light-eventuate-4j/architecture/event-driven/" title="Event Driven Architecture">
        <span class="direction">
          Previous
        </span>
        <div class="page">
          <div class="button button-previous" role="button" aria-label="Previous">
            <i class="icon icon-back"></i>
          </div>
          <div class="stretch">
            <div class="title">
              Event Driven Architecture
            </div>
          </div>
        </div>
      </a>
  
  </div>

  <div class="next">
  
      <a href="https://networknt.github.io/light-eventuate-4j/design/component/" title="Components">
        <span class="direction">
          Next
        </span>
        <div class="page">
          <div class="stretch">
            <div class="title">
              Components
            </div>
          </div>
          <div class="button button-next" role="button" aria-label="Next">
            <i class="icon icon-forward"></i>
          </div>
        </div>
      </a>
  
  </div>
</nav>





			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = 'https:\/\/networknt.github.io\/light-eventuate-4j';
      var repo_id  = 'networknt\/light-eventuate-4j';
    
    </script>

    <script src="https://networknt.github.io/light-eventuate-4j/javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;

            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }


        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "#";
            headers[i].appendChild(a);
        }
      }
    </script>

    

    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>

